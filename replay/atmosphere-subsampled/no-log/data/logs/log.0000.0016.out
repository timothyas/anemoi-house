[7 s] [INFO   ] 
MPITopology Summary
-------------------
comm: MPI_COMM_WORLD
rank              : 00
size              : 16
pid               : 37732
log_dir           : ./logs
logfile           : ./logs/log.0000.0016.out
Thread Support
required_level    : 3
provided_level    : 3

[10 s] [INFO   ] 
Source: GCSReplayAtmosphere
---------------------------
time              : DatetimeIndex(['1994-01-01 00:00:00', '1994-01-01 03:00:00',
               '1994-01-01 06:00:00', '1994-01-01 09:00:00',
               '1994-01-01 12:00:00', '1994-01-01 15:00:00',
               '1994-01-01 18:00:00', '1994-01-01 21:00:00',
               '1994-01-02 00:00:00', '1994-01-02 03:00:00',
               ...
               '1994-03-30 18:00:00', '1994-03-30 21:00:00',
               '1994-03-31 00:00:00', '1994-03-31 03:00:00',
               '1994-03-31 06:00:00', '1994-03-31 09:00:00',
               '1994-03-31 12:00:00', '1994-03-31 15:00:00',
               '1994-03-31 18:00:00', '1994-03-31 21:00:00'],
              dtype='datetime64[ns]', length=720, freq='3h')
variables         : ['ugrd', 'vgrd', 'dzdt', 'tmp', 'spfh', 'pressfc', 'ugrd10m', 'vgrd10m', 'tmp2m', 'spfh2m', 'land_static', 'hgtsfc_static', 'delz']
levels            : None
use_nearest_levels: False
slices            : {}

[11 s] [INFO   ] 
Transformations
---------------
options
    fv_vertical_regrid: {'weight_var': 'delz', 'interfaces': [0, 200, 500, 800, 1000], 'use_nearest_interfaces': True, 'keep_weight_var': False}

[11 s] [INFO   ] 
Target: Anemoi
--------------
store_path        : ./dataset.zarr
forcings          : ['cos_latitude', 'sin_latitude', 'cos_longitude', 'sin_longitude', 'cos_julian_day', 'sin_julian_day', 'cos_local_time', 'sin_local_time', 'insolation']
chunks
    time          : 1
    variable      : -1
    ensemble      : 1
    cell          : -1
rename
    

[11 s] [INFO   ] 
Mover: MPIDataMover
-------------------
local_batch_index : 00
data_per_process  : 01
batch_size        : 16
Total Samples     : 720
Total Batches     : 45
sample_dims       : ('time',)

[14 s] [INFO   ] MPIDataMover.create_container: stored container at ./dataset.zarr
<xarray.Dataset> Size: 8GB
Dimensions:         (time: 720, variable: 36, ensemble: 1, cell: 73728)
Coordinates:
  * time            (time) int64 6kB 0 1 2 3 4 5 6 ... 714 715 716 717 718 719
  * variable        (variable) int64 288B 0 1 2 3 4 5 6 ... 29 30 31 32 33 34 35
  * ensemble        (ensemble) int64 8B 0
  * cell            (cell) int64 590kB 0 1 2 3 4 ... 73724 73725 73726 73727
Data variables:
    count_array     (time, variable, ensemble) float64 207kB dask.array<chunksize=(1, 36, 1), meta=np.ndarray>
    data            (time, variable, ensemble, cell) float32 8GB dask.array<chunksize=(1, 36, 1, 73728), meta=np.ndarray>
    has_nans_array  (time, variable, ensemble) bool 26kB dask.array<chunksize=(1, 36, 1), meta=np.ndarray>
    latitudes       (cell) float64 590kB dask.array<chunksize=(73728,), meta=np.ndarray>
    longitudes      (cell) float64 590kB dask.array<chunksize=(73728,), meta=np.ndarray>
    maximum_array   (time, variable, ensemble) float64 207kB dask.array<chunksize=(1, 36, 1), meta=np.ndarray>
    minimum_array   (time, variable, ensemble) float64 207kB dask.array<chunksize=(1, 36, 1), meta=np.ndarray>
    squares_array   (time, variable, ensemble) float64 207kB dask.array<chunksize=(1, 36, 1), meta=np.ndarray>
    sums_array      (time, variable, ensemble) float64 207kB dask.array<chunksize=(1, 36, 1), meta=np.ndarray>
Attributes: (12/14)
    variables_metadata:     {'ugrd_100': {'mars': {'date': '19940101', 'param...
    remapping:              {'param_level': '{param}_{levelist}'}
    stack_order:            ['latitudes', 'longitudes']
    field_shape:            [192, 384]
    variables:              ['cos_julian_day', 'cos_latitude', 'cos_local_tim...
    allow_nans:             True
    ...                     ...
    resolution:             None
    start_date:             1994-01-01T00:00:00
    end_date:               1994-03-31T21:00:00
    frequency:              3h
    statistics_start_date:  1994-01-01T00:00:00
    statistics_end_date:    1994-02-28T21:00:00

[17 s] [INFO   ] Done with batch 1 / 45
[20 s] [INFO   ] Done with batch 2 / 45
[24 s] [INFO   ] Done with batch 3 / 45
[26 s] [INFO   ] Done with batch 4 / 45
[29 s] [INFO   ] Done with batch 5 / 45
[32 s] [INFO   ] Done with batch 6 / 45
[35 s] [INFO   ] Done with batch 7 / 45
[38 s] [INFO   ] Done with batch 8 / 45
[41 s] [INFO   ] Done with batch 9 / 45
[44 s] [INFO   ] Done with batch 10 / 45
[48 s] [INFO   ] Done with batch 11 / 45
[50 s] [INFO   ] Done with batch 12 / 45
[54 s] [INFO   ] Done with batch 13 / 45
[58 s] [INFO   ] Done with batch 14 / 45
[66 s] [INFO   ] Done with batch 15 / 45
[71 s] [INFO   ] Done with batch 16 / 45
[77 s] [INFO   ] Done with batch 17 / 45
[84 s] [INFO   ] Done with batch 18 / 45
[89 s] [INFO   ] Done with batch 19 / 45
[95 s] [INFO   ] Done with batch 20 / 45
[101 s] [INFO   ] Done with batch 21 / 45
[104 s] [INFO   ] Done with batch 22 / 45
[109 s] [INFO   ] Done with batch 23 / 45
[113 s] [INFO   ] Done with batch 24 / 45
[117 s] [INFO   ] Done with batch 25 / 45
[122 s] [INFO   ] Done with batch 26 / 45
[125 s] [INFO   ] Done with batch 27 / 45
[128 s] [INFO   ] Done with batch 28 / 45
[131 s] [INFO   ] Done with batch 29 / 45
[135 s] [INFO   ] Done with batch 30 / 45
[138 s] [INFO   ] Done with batch 31 / 45
[141 s] [INFO   ] Done with batch 32 / 45
[144 s] [INFO   ] Done with batch 33 / 45
[148 s] [INFO   ] Done with batch 34 / 45
[151 s] [INFO   ] Done with batch 35 / 45
[154 s] [INFO   ] Done with batch 36 / 45
[157 s] [INFO   ] Done with batch 37 / 45
[161 s] [INFO   ] Done with batch 38 / 45
[164 s] [INFO   ] Done with batch 39 / 45
[169 s] [INFO   ] Done with batch 40 / 45
[173 s] [INFO   ] Done with batch 41 / 45
[178 s] [INFO   ] Done with batch 42 / 45
[182 s] [INFO   ] Done with batch 43 / 45
[186 s] [INFO   ] Done with batch 44 / 45
[190 s] [INFO   ] Done with batch 45 / 45
[204 s] [INFO   ] Done moving the data

[204 s] [INFO   ] Anemoi.add_dates: dates appended to the dataset

[204 s] [INFO   ] Aggregating statistics
[204 s] [INFO   ] Anemoi.aggregate_stats: Performing local computations
[205 s] [INFO   ] Anemoi.aggregate_stats: Communicating results to root
[205 s] [INFO   ] Anemoi.aggregate_stats: ... done communicating
[206 s] [INFO   ] Anemoi.aggregate_stats: Stored aggregated stats
[206 s] [INFO   ] Done aggregating statistics

[206 s] [INFO   ] Storing the recipe and anything from the 'attrs' section in zarr store attributes
[206 s] [INFO   ] ðŸš€ðŸš€ðŸš€ Dataset is ready for launch at: ./dataset.zarr
